---
import { Image } from 'astro:assets';
import Layout from '../layouts/Layout.astro';
import Button from '../components/Button.astro';
import ScrollReveal from '../components/ScrollReveal.astro';
import MuxVideo from '../components/MuxVideo.astro';
import hero from '../assets/hero.png';
import heroMobile from '../assets/hero-mobile.png';
import heroProj2 from '../assets/poc/project-hero-2.png';
import BaselineReveal from '../components/BaselineReveal.astro';
import { client, urlFor } from '../lib/sanity';
import type { MainPage } from '../types/sanity';

// Fetch MainPage data from Sanity
const mainPage = await client.fetch<MainPage>(
  `*[_type == "mainPage"][0]{
    _id,
    title,
    slug,
    hero{
      mediaType,
      image{
        asset,
        alt
      },
      video{
        asset->{
          playbackId
        }
      },
      mobileMediaType,
      mobileImage{
        asset,
        alt
      },
      mobileVideo{
        asset->{
          playbackId
        }
      }
    }
  }`
);
---

<Layout title="Symbold">
  <section id="headers" class="content-padding">
    <BaselineReveal>
      <h1 class="page-title">brutally honest <br /> branding</h1>
    </BaselineReveal>
    <BaselineReveal delayed>
      <h2 class="mt-2 text-base font-medium md:text-2xl">
        we create conceptual, ambitious, and profound brand identities.
      </h2>
    </BaselineReveal>

    <Button class="mt-10" href="/contact">Work with us</Button>
  </section>

  <section id="hero" class="edge-padding mt-10 w-full md:mt-40">
    {
      mainPage?.hero ? (
        <>
          {/* Mobile Hero */}
          {mainPage.hero.mobileMediaType === 'image' && mainPage.hero.mobileImage ? (
            <Image
              src={urlFor(mainPage.hero.mobileImage)?.url() || ''}
              alt={mainPage.hero.mobileImage.alt || 'Hero'}
              class="h-auto w-full md:hidden"
              inferSize
            />
          ) : mainPage.hero.mobileMediaType === 'video' &&
            mainPage.hero.mobileVideo?.asset?.playbackId ? (
            <div class="md:hidden">
              <MuxVideo
                playbackId={mainPage.hero.mobileVideo.asset.playbackId}
                videoTitle={mainPage.title || 'Hero Video'}
              />
            </div>
          ) : null}

          {/* Desktop Hero */}
          {mainPage.hero.mediaType === 'image' && mainPage.hero.image ? (
            <Image
              src={urlFor(mainPage.hero.image)?.url() || ''}
              alt={mainPage.hero.image.alt || 'Hero'}
              class="hidden h-auto w-full md:block"
              inferSize
            />
          ) : mainPage.hero.mediaType === 'video' && mainPage.hero.video?.asset?.playbackId ? (
            <div class="hidden md:block">
              <MuxVideo
                playbackId={mainPage.hero.video.asset.playbackId}
                videoTitle={mainPage.title || 'Hero Video'}
              />
            </div>
          ) : null}
        </>
      ) : (
        <>
          {/* Fallback to static assets if no Sanity data */}
          <Image src={heroMobile} alt="Hero" class="h-auto w-full md:hidden" />
          <Image src={hero} alt="Hero" class="hidden h-auto w-full md:block" />
        </>
      )
    }
  </section>

  <ScrollReveal>
    <h2 class="mt-20 text-center text-xl leading-tight font-bold md:mt-60 md:text-4xl">
      We don't make the logo bigger.
      <br />
      We craft strategic, bold brands that move businesses forward.
      <br />
      We are agile, efficient & creative
    </h2>
  </ScrollReveal>

  <ScrollReveal>
    <div class="edge-padding mt-20 md:mt-60">
      <div>
        <MuxVideo playbackId="FNxQJaU02uRsOBFTwOF7UTFTg4YnZMzRGtTwBfLR3KLg" videoTitle="Brancusi" />
      </div>
    </div>
  </ScrollReveal>

  <div class="edge-padding mt-4 flex flex-col gap-4 md:flex-row md:gap-4">
    <ScrollReveal class="w-full md:w-1/2">
      <Image src={heroProj2} alt="Hero Project 2" class="h-auto w-full" />
    </ScrollReveal>
    <ScrollReveal delayed class="w-full md:w-1/2">
      <div class="w-full">
        <MuxVideo
          playbackId="jKdX00whICbkRA3qni4OlyaV01ogVdhq7lwYxx00FE9twY"
          videoTitle="Outdoorz"
        />
      </div>
    </ScrollReveal>
  </div>

  <ScrollReveal>
    <a href="/work" class="link-primary mt-10 block text-center">See our work</a>
  </ScrollReveal>

  <ScrollReveal>
    <h2
      class="mx-auto mt-10 w-full text-center text-xl leading-tight font-bold md:mt-30 md:w-1/2 md:text-4xl"
    >
      We are not for everyone.
      <br />
      Symbold partners only with visionaries who value design as strategy, not decoration.
    </h2>
  </ScrollReveal>

  <div class="content-padding mt-30 flex items-center justify-center">
    <Button href="/contact">Work with us</Button>
  </div>

  <div class="content-padding">
    <hr class="mt-30 mb-10 md:mb-30" />
  </div>
</Layout>
